@model Satyanam.Nop.Plugin.Misc.MenuManager.Models.MenuSettingsViewModel
@using Nop.Core.Infrastructure;
@using Nop.Web.Framework.UI;
@using Satyanam.Nop.Plugin.Misc.MenuManager;
@{


    NopHtml.AppendCssFileParts("~/Plugins/Misc.MenuManager/Themes/DefaultClean/Content/Menumanager.css");
    var isRtl = false;//this.ShouldUseRtlTheme();
}
@{
    var stickMenu = EngineContext.Current.Resolve<MenuManagerSettings>().StickMenuOnTop;
}

@{
    var menuManagerSettings = EngineContext.Current.Resolve<MenuManagerSettings>();
    var fontcolor = menuManagerSettings.FontColor;
    var bgcolor = menuManagerSettings.BackgroundColor;
    var fontsize = menuManagerSettings.FontSize;
    var fontfamily = menuManagerSettings.FontStyle;
}

<style type="text/css">

    .top-menu > li > a, .top-menu > li > span {
        color: @fontcolor;
        font-size: @fontsize;
        font-family: @fontfamily;
    }

    .top-menu {
        background-size: contain;
        background: @bgcolor;
        background-image: url("@Model.BgPictureUrl");
        background-repeat: repeat-x;
    }
</style>

<text>
    @if (Model.StickMenuOnTop)
    {
        <div id="menuManager">
            <ul class="@ViewBag.MainMenuClass">
                @Html.Raw(ViewBag.MenuItems)
            </ul>
        </div>
        <div id="menuAlias"></div>
        <script>
            $(function () {
                // Check the initial Poistion of the Sticky Header
                var stickyHeaderTop = $('#menuManager').offset().top;

                $(window).scroll(function () {
                    if ($(window).scrollTop() > stickyHeaderTop) {
                        $('#menuManager').css({ position: 'fixed', top: '0px' });
                        $('#menuAlias').css('display', 'block');
                    } else {
                        $('#menuManager').css({ position: 'static', top: '0px' });
                        $('#menuAlias').css('display', 'none');
                    }
                });
            });
        </script>
    }
    else
    {
        <ul class="@ViewBag.MainMenuClass">
            @Html.Raw(ViewBag.MenuItems)

            <li class="wishlist">
                <a href="@Url.RouteUrl("Wishlist")" class="ico-wishlist">@T("Wishlist")</a>
            </li>
            <li id="topcartlink" class="flyOver">
                <a class="ico-cart" href="/cart">
                    <span class="cart-label">@T("ShoppingCart")</span>
                </a>

                @Html.ActionLink("FlyoutShoppingCart", "ShoppingCart")
            </li>

        </ul>

    }

</text>
<text>
    @if (stickMenu)
    {
        <div id="menuStickMobile">
            @*<div id="mob-menu-button">
                    <a href="">
                        <span class="icon"><span class="line"></span><span class="line"></span><span class="line"></span></span>
                        <span>&nbsp;</span>
                    </a>
                </div>*@
            @if (ViewBag.SupportResponsive)
            {
                <text>
                <ul class="mob-top-menu">
                    @Html.Raw(ViewBag.MenuItems)
                </ul>
                </text>
            }


        </div>
        <div id="menuAlias"></div>
        <script>
            $(function () {
                // Check the initial Poistion of the Sticky Header
                var stickyHeaderTop = $('#menuStickMobile').offset().top;

                $(window).scroll(function () {
                    if ($(window).scrollTop() > stickyHeaderTop) {
                        $('#menuStickMobile').css({ position: 'fixed', top: '0px' });
                        $('#menuAlias').css('display', 'block');

                    } else {
                        $('#menuStickMobile').css({ position: 'static', top: '0px' });
                        $('#menuAlias').css('display', 'none');
                    }
                });
            });
        </script>
    }
    else
    {

        if (ViewBag.SupportResponsive)
        {
            <text>
            <ul class="mob-top-menu">
                @Html.Raw(ViewBag.MenuItems)
            </ul>
            </text>
        }

    }

</text>



<script>

        $('li', '.top-menu').on('mouseenter', function () {
            $('a', $(this)).first().addClass('hover');
            if (!$(this).parent().hasClass('top-menu')) {
                var width = $(this).innerWidth();
                $('.sublist', $(this)).first().css('@(isRtl ? "right" : "left")', width + 15);
                $('.subNoPic', $(this)).first().css('@(isRtl ? "right" : "left")', width + 15);
            }
            $('.sublist', $(this)).first().addClass('active');
            $('.subNoPic', $(this)).first().addClass('active');
            $('.top-menu-triangle', $(this)).addClass('active');
        });

        $('li', '.top-menu').on('mouseleave', function () {
            $('a', $(this)).first().removeClass('hover');
            $('.sublist', $(this)).first().removeClass('active');
            $('.subNoPic', $(this)).first().removeClass('active');
            $('.top-menu-triangle', $(this)).removeClass('active');
        });

</script>

<script type="text/javascript">


        $(document).ready(function () {

            $('.mob-top-menu .top-menu-triangle').click(function () {
                $(this).siblings('.sublist').addClass('active');
                $(this).siblings('.subNoPic').addClass('active');

                $('.sublist span').click(function () {
                    $('.mob-top-menu .sublist.firstLevel').removeClass('active');
                });
                $('.subNoPic span').click(function () {
                    $('.mob-top-menu .subNoPic').removeClass('active');
                });

            });
        });

</script>

<script type="text/javascript">
        $(document).ready(function () {

            $("div").remove(".wishlist-shoping");

            $('.header-menu .top-menu').on('mouseenter', '.flyOver', function () {
                $('#flyout-cart').addClass('active');
            });
            $('.header-menu .top-menu').on('mouseleave', '.flyOver', function () {
                $('#flyout-cart').removeClass('active');
            });
            $('.header-menu .top-menu').on('mouseenter', '#flyout-cart', function () {
                $('#flyout-cart').addClass('active');
            });
            $('.header-menu .top-menu').on('mouseleave', '#flyout-cart', function () {
                $('#flyout-cart').removeClass('active');
            });



        });

</script>
